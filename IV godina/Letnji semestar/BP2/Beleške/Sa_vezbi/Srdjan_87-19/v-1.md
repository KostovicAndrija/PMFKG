sql server se konfigurise tako da se smanje troskovi

jedna od ideja za optimizaciju je da se ubrza rad kroz koriscenje indeksa, gde se optimizacija u stvari vrsi nad IO operacijama posto su one dosta spore

indeksi ne povecvaju broj funkcionalnosti sistema, ali poboljsavaju upotrebljivost sistema

indeks - struktura podataka koja ubrzava pretrazivanje podataka u bazi

data engine-i najcesce ne rasporedjuju pristigle podatke, vec ocekuju da ti podaci kasnije budu sortirani

podaci se redjaju na "gomilu" (heap)


ms sql 

tabela se posmatra kao skup stranica
nije stvarna reprezentacija, to su u memoriji blokovi, ali dbms ih tako posmatra (svuda osim u storage manageru)


# Heap

neuredjena kolekcija stranica

ako se za rasporedjivanje ne koriste indeksi onda su podaci organizovani kao heap

ako zafale stranice one se alociraju i dodaju heap-u i na taj nacin se tabela siri

ovaj nacin je efikasan jer stedi prostor.
nema ogranicenja na prostor podataka.
nije potrebno da se trazi prazno mesto na koje bi se novi podaci umetnuli, ali nema nikakav vide uredjenja i sortiranja podataka, sto otezava pretragu

da bi se nasao podatak koji zadovoljava upit potrebno je da se prodje kroz ceo heap. To se naziva table scan-om. 

Priihvatljivo je kada se trazi cela tabela. Za sve drugo nije korisno.

# Indeksi

resavaju problem sa uslovima koje ima heap.

Sadrze kopiju dela podataka iz tabela, tj. jednu ili vise kolona. 

Kolone u indeksu predstavljaju kljuc pretrage (search key). Na osnovu njega se vrsi pretraga.


indeks = (kljuc_pretrag, pokazivac)

sql server koristi balansirano B stablo kao strukturu indeksa

u listovima se nalaze sami podaci, dok su u ostalim cvorovima pokazivaci

stqblo je balansirano => svi listovi se nalaze na relativno istom rastojanju od korena

u jednom cvoru se moze naci vise podataka iz zapisa

svaki cvor je jedna stranica

listovi su sortirani prema kljucu pretrage

svaki nivo je povezan dvostrukom listom kako bi moglo kroz te nivoe da se prolazi brzi

sami listovi mogu da sadrze pokazivace ili stranicu tabele

query processor krece od root cvora i onda uporedjuje vrednost sa indeksnim kljucevima, ne ucitavaju se neke stranice koje ne ispunjavaju uslov pa se manje memorije zauzima (?)

indeksi kod kojih se u listovima nalaze fizicki podaci o listovima (???) nazivaju se **klasterizovani indeksi**

# Klasterizovani indeksi

podaci su fizicki sortirani na nivou stranice 

neuredjeni podaci se sortiraju pa se od njih kreira
B stablo

stranice tabele se mogu posmatrati kao listovi

prolaskom kroz stablo dolazi se u blizinu trazenog
podatka (ucitava se stranica iz memorije koja sadrzi
podatak koji se trazi)

najmanja jedinica koja se moze ucitati iz memorije je
stranica

kljuc pretrage je najcesce PK

nakon sto se za tabelu formira katerovani inteks onda
se on koristi za pretrazivanje tabele 
(1 tabela - 1 klasterovani indeks)
podaci tabele su rasporedjani sekvencijalno, po
kljucu pretrage


kada se postavi primarni kljuc onda se on postalja 
automatski da bude klasterizovani indeks.

Najvise 1 klasterovani indeks moze da se formira za
1 tabelu (zasto? zato sto podaci mogu da se sortiraju
samo na jedan nacin u jednom trenutku)


